{"version":3,"sources":["webparts/reactAppLoader/ReactAppLoaderWebPart.ts"],"names":[],"mappings":"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","file":"webparts/reactAppLoader/ReactAppLoaderWebPart.js","sourcesContent":["import {\r\n  BaseClientSideWebPart,\r\n  IPropertyPaneConfiguration,\r\n  PropertyPaneTextField\r\n} from '@microsoft/sp-webpart-base';\r\n\r\n\r\nexport interface IReactAppLoaderWebPartProps {\r\n  description: string;\r\n  scripts:string;\r\n  css:string;\r\n  rootElement:string;\r\n}\r\n\r\nfunction addScript(src: string,wpCtn: string) {\r\n  return new Promise((resolve, reject) => {\r\n    const s = document.createElement('script');\r\n\r\n    s.setAttribute('src', src);\r\n    s.setAttribute('wpContainer', wpCtn);\r\n    s.addEventListener('load', resolve);\r\n    s.addEventListener('error', reject);\r\n\r\n    document.body.appendChild(s);\r\n  });\r\n}\r\nfunction addCss(href: string) {\r\n  const head: any = document.getElementsByTagName(\"head\")[0] || document.documentElement;\r\n  let customStyle: HTMLLinkElement = document.createElement(\"link\");\r\n  customStyle.href = href;\r\n  customStyle.rel = \"stylesheet\";\r\n  customStyle.type = \"text/css\";\r\n  head.insertAdjacentElement(\"beforeEnd\", customStyle);\r\n  \r\n}\r\ndeclare global {\r\n  interface Window { spContext: any; wpProperties:any }\r\n}\r\n\r\nexport default class React18WpWebPart extends BaseClientSideWebPart<IReactAppLoaderWebPartProps> {\r\n\r\n  \r\n  public render(): void {\r\n\r\n    window.spContext = this.context;\r\n    window.wpProperties = this.properties;\r\n\r\n    try {\r\n    this.properties.scripts.split(\";\").forEach((s)=>{\r\n      addScript(s,this.properties.rootElement);\r\n    });\r\n\r\n    this.properties.css.split(\";\").forEach((c)=>{\r\n      addCss(c);\r\n    });\r\n    }\r\n    catch(e){\r\n      console.log(\"errores al cargar\");\r\n    }\r\n\r\n    this.domElement.innerHTML = \"<div id=\\\"\" + this.properties.rootElement + \"\\\"></div>\";\r\n  }\r\n\r\n\r\n  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {\r\n    return {\r\n      pages: [\r\n        {\r\n          header: {\r\n            description: \"Descripcio√≥n\"\r\n          },\r\n          groups: [\r\n            {\r\n              groupName: \"ReactApp files\",\r\n              groupFields: [\r\n                PropertyPaneTextField('description', {\r\n                  label: \"Descripcion\"\r\n                }),\r\n                PropertyPaneTextField('scripts', {\r\n                  label: \"scripts\"\r\n                }),\r\n                PropertyPaneTextField('css', {\r\n                  label: \"css\"\r\n                }),\r\n                PropertyPaneTextField('rootElement', {\r\n                  label: \"root\"\r\n                })\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n}\r\n"],"sourceRoot":"../../../src"}